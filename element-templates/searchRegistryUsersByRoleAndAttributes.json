{
  "name": "Search registry users",
  "id": "searchRegistryUsersByRoleAndAttributes",
  "appliesTo": [
    "bpmn:ServiceTask"
  ],
  "properties": [
    {
      "label": "Implementation Type",
      "type": "Hidden",
      "value": "${searchRegistryUsersByRoleAndAttributes}",
      "editable": false,
      "binding": {
        "type": "property",
        "name": "camunda:delegateExpression"
      }
    },
    {
      "label": "Realm",
      "description": "Realm where it's needed to search users",
      "type": "Dropdown",
      "choices": [
        {
          "name": "OFFICER",
          "value": "officer"
        },
        {
          "name": "CITIZEN",
          "value": "citizen"
        }
      ],
      "binding": {
        "type": "camunda:inputParameter",
        "name": "realm"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Status",
      "description": "Retrieve users based on the specified Keycloak account status",
      "type": "Dropdown",
      "choices": [
        {
          "name": "ALL",
          "value": "all"
        },
        {
          "name": "ENABLED",
          "value": "true"
        },
        {
          "name": "DISABLED",
          "value": "false"
        }
      ],
      "binding": {
        "type": "camunda:inputParameter",
        "name": "status"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Username",
      "type": "String",
      "binding": {
        "type": "camunda:inputParameter",
        "name": "username"
      }
    },
    {
      "label": "Role name",
      "description": "Keycloak role name",
      "type": "String",
      "binding": {
        "type": "camunda:inputParameter",
        "name": "role_name"
      },
      "constraints": {
        "type": "role.name"
      }
    },
    {
      "label": "Attributes Equals",
      "description": "Map of the attributes for exact match search",
      "binding": {
        "type": "camunda:inputParameter",
        "name": "attributesEquals"
      }
    },
    {
      "label": "Attributes Starts With",
      "description": "Map of the attributes for starts with search",
      "binding": {
        "type": "camunda:inputParameter",
        "name": "attributesStartWith"
      }
    },
    {
      "label": "Attributes that are start for",
      "description": "Map containing attributes user must have start for (former inversive starts with). Works like starts with but with switched parameters. For example: input value of some attribute is 'level80' and user to be found has to contain that attribute with value that is a start for it e.g. 'l', 'level', 'level8', 'level80' (user with 'level801' won't be returned as this whole value isn't a start for 'level80'). ",
      "binding": {
        "type": "camunda:inputParameter",
        "name": "attributesThatAreStartFor"
      }
    },
    {
      "label": "Limit",
      "description": "Number of users to retrieve, hard limit is 100. If unspecified, less than 0, or exceeds, hard limit will be applied",
      "type": "String",
      "binding": {
        "type": "camunda:inputParameter",
        "name": "limit"
      },
      "value": "100"
    },
    {
      "label": "Offset",
      "description": "Number of users to skip before returning results. Defaults to 0 if not provided",
      "type": "String",
      "binding": {
        "type": "camunda:inputParameter",
        "name": "offset"
      }
    },
    {
      "label": "Result variable",
      "description": "The process variable to put the users response",
      "type": "String",
      "value": "usersResponse",
      "binding": {
        "type": "camunda:outputParameter",
        "source": "${ usersResponse }"
      },
      "constraints": {
        "notEmpty": true
      }
    }
  ]
}